#!/bin/ash

USERNAME='dev01'
PASSWORD='Soulless_Developer#2022'
REPO_NAME='pwn_me_please'

# Login
CSRF=$(wget 172.17.0.1:3000/user/login -O - | sed -n 's/.*name="_csrf"\svalue="\([^"]*\)">.*/\1/p')
LOGIN_COOKIE=$(wget 172.17.0.1:3000/user/login --post-data="user_name=$USERNAME&password=$PASSWORD&_csrf=$CSRF" -O -)

# Create repo
CSRF=$(wget 172.17.0.1:3000/repo/create -O - | sed -n 's/.*name="_csrf"\svalue="\([^"]*\)">.*/\1/p')
UID='TODO'
wget 172.17.0.1:3000/repo/create --port-data="uid=$UID&auto_init='on'&readme='Default'&repo_name=$REPO_NAME&trust_model='default'&default_branch='master'&_csrf=$CSRF" -O -
